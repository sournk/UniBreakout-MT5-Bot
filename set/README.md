# UniBreakout-MT5-Bot

* Coding by Denis Kislitsyn | denis@kislitsyn.me | [kislitsyn.me](https://kislitsyn.me/personal/algo)
* Version: 1.00

## Что нового?
```
1.00: First version
```

## Описание стратегии

**UniBreakout-MT5-Bot** — универсальный торговый советник для торговли на пробой или отбой от границ сессионного диапазона. Бот определяет канал на основе заданной сессии и открывает позиции при пробое или отскоке от его границ.

### Принцип работы

Бот автоматически:
1. **Определяет сессионный диапазон** — строит канал на основе high/low заданного временного окна, используя индикатор `SessionRange`
2. **Ожидает сигнал** — следит за пробоем или отбоем от границ канала
3. **Открывает позицию** — Breakout (по направлению пробоя) или Rebound (отскок от границы)
4. **Устанавливает SL/TP** — по ATR, ближней/дальней границе или центру канала
5. **Применяет TSL** — опциональный трейлинг-стоп на каждом баре
6. **Управляет рисками** — расчет лота по MM с ограничением риска

## Installation | Установка

См. [README_INSTALL.md](README_INSTALL.md)

## Bot's Input Parameters

#### 1. SESSION (S) — Параметры сессии

- **`S_STH`**: Session Start Hour [0-23]
  - Час начала сессии для построения диапазона
  - По умолчанию: `0`

- **`S_STM`**: Session Start Min [0-59]
  - Минута начала сессии
  - По умолчанию: `0`

- **`S_DUR`**: Session Duration min [0-1440]
  - Длительность сессии в минутах
  - По умолчанию: `1440` (24 часа)

- **`S_MOD`**: Session Mode
  - **Тип**: `ENUM_SESSION_MODE`
  - Режим расчета сессии (текущая/предыдущая)
  - По умолчанию: `SESSION_MODE_PREV`

#### 2. IN (I) — Параметры входа

- **`I_DIR_MOD`**: In Dir Mode
  - **Тип**: `ENUM_SETUP_MODE`
  - Режим входа в позицию
  - Варианты:
    - `Breakout` — вход на пробой границы
    - `Rebound` — вход на отбой от границы
  - По умолчанию: `SETUP_MODE_BREAKOUT`

- **`I_SLTP_MOD`**: SL/TP Mode
  - **Тип**: `ENUM_SLTP_MODE`
  - Режим расчета SL и TP
  - Варианты:
    - `SL by ATR / TP by RR` — SL по ATR, TP по соотношению RR
    - `NEAREST` — SL или TP к ближней границе канала
    - `CENTER` — SL или TP к центру канала
    - `OUTER` — SL или TP к дальней границе канала
  - По умолчанию: `SLTP_MODE_ATR`

- **`I_MM_MOD`**: Money Management Type
  - **Тип**: `ENUM_MM_TYPE`
  - Режим управления капиталом
  - По умолчанию: `ENUM_MM_TYPE_AUTO_LIMIT_RISK`

- **`I_MM_VAL`**: Money Management Value
  - Значение для расчета лота (> 0)
  - По умолчанию: `1.0`

- **`I_ATR_PER`**: ATR Period
  - Период ATR для расчета SL (> 0)
  - По умолчанию: `14`

- **`I_ATR_MUL`**: ATR SL Multiplicator
  - Множитель ATR для SL (> 0)
  - По умолчанию: `2.0`

- **`I_TP_RR`**: TP RR
  - Соотношение TP к риску (> 0)
  - По умолчанию: `2.0`

#### 3. OUT (O) — Параметры выхода

- **`O_TSL_ENB`**: TSL on bar Enabled
  - **Тип**: `bool`
  - Включить трейлинг-стоп на каждом баре
  - По умолчанию: `false`

#### 4. FILTER (F) — Параметры фильтров

- **`F_DIR_MOD`**: Setup Mode
  - **Тип**: `ENUM_TRADE_DIR`
  - Ограничение направлений входа
  - Варианты: `Both`, `Buy`, `Sell`
  - По умолчанию: `Both`

- **`F_TIM_MON` - `F_TIM_SUN`**: Разрешенные временные интервалы
  - **Формат**: `"HH:MM(:SS)"` (через `;` для нескольких)
  - Пустая строка — торговля в этот день запрещена
  - По умолчанию: `"00:00-23:59:59"`

#### 5. MISC (MS) — Служебные параметры

- **`_MS_MGC`**: Expert Adviser ID - Magic
  - Уникальный идентификатор советника
  - По умолчанию: `20260121`

- **`_MS_EGP`**: Expert Adviser Global Prefix
  - Глобальный префикс для имени советника
  - По умолчанию: `"UniBO"`

- **`_MS_LOG_LL`**: Log Level
  - Уровень логирования: `ERROR`, `WARNING`, `INFO`, `DEBUG`, `TRACE`
  - По умолчанию: `INFO`

- **`_MS_LOG_FI`**: Log Filter IN String
  - Фильтр включения записей в лог (через `;`)

- **`_MS_LOG_FO`**: Log Filter OUT String
  - Фильтр исключения записей из лога (через `;`)

- **`_MS_COM_EN`**: Comment Enable
  - Включить комментарий на графике
  - По умолчанию: `true`

- **`_MS_COM_IS`**: Comment Interval, ms
  - Интервал обновления комментария
  - По умолчанию: `30000`

- **`_MS_COM_CW`**: Comment Custom Window
  - Использовать кастомное окно
  - По умолчанию: `false`

- **`_MS_HIN_N`**: On Chart Hints Count
  - Количество подсказок на графике (<0-off; 0-no lim)
  - По умолчанию: `3600`

- **`_MS_OTR_MOD`**: On Tester Result calculation Mode
  - Режим расчета результатов: `Off`, `Pearson`, `Spearman`
  - По умолчанию: `Spearman`

- **`_MS_OTR_TF`**: On Tester Result Timeframe
  - По умолчанию: `PERIOD_H1`

- **`_MS_TIM_MS`**: Timer Interval, ms
  - По умолчанию: `60000`

## Особенности стратегии

### Сессионный диапазон
Бот строит канал на основе high/low за заданный период сессии. Можно использовать предыдущую или текущую сессию.

### Режимы входа
- **Breakout** — вход при пробое границы канала в направлении пробоя
- **Rebound** — вход при касании границы канала в противоположном направлении

### Гибкая настройка SL/TP
- По ATR с заданным множителем
- К ближней/дальней границе канала
- К центру канала

### Временные фильтры
Торговля только в определенные дни и часы. Полезно для исключения периодов низкой ликвидности.
